projname_add_library(${PROJECT_NAME}
  SOURCES
    lockable.hpp
    projname.cpp
    projname.hpp
  DEPENDS
    Threads::Threads
    Boost::system
    Boost::date_time
    Boost::diagnostic_definitions
    Boost::disable_autolinking
    Boost::dynamic_linking
    $<$<TARGET_EXISTS:boost_throw_exception>:boost_throw_exception>
)

projname_add_executable(${PROJECT_NAME}_tool
  SOURCES
    projname_main.cpp
  DEPENDS
    ${PROJECT_NAME}
    $<$<TARGET_EXISTS:boost_throw_exception>:boost_throw_exception>
)

if(BUILD_TESTING)
    projname_add_test(${PROJECT_NAME}_test
      SOURCES
        lockable_test.cpp
        projname_test.cpp
      DEPENDS
        ${PROJECT_NAME}
        $<$<TARGET_EXISTS:boost_throw_exception>:boost_throw_exception>
        gtest_main
      EXTRA_ARGS
        --gtest_color=yes
    )

    if(BUILD_BENCHMARKS)
        projname_add_test(${PROJECT_NAME}_bench
          SOURCES
            lockable_bench.cpp
          DEPENDS
            ${PROJECT_NAME}
            $<$<TARGET_EXISTS:boost_throw_exception>:boost_throw_exception>
            benchmark_main
        )
    endif()
endif()
